<!doctype html><html lang="en"><head><meta charset="utf-8"><title>New Website</title><meta name="description" content="The new Website, has just been created!"><meta property="og:image" content="https://"><meta property="og:title" content="New Website"><meta property="og:description" content="The new Website, has just been created!"><meta property="og:type" content="website"><meta property="og:url" content="https://"><meta property="og:locale" content="en_US"><link rel="manifest" href="manifest.json"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"><meta name="viewport" content="width=device-width,initial-scale=1"><style>a,abbr,acronym,address,article,aside,b,big,blockquote,body,caption,cite,code,dd,del,dfn,div,dl,dt,em,fieldset,footer,form,h1,h2,h3,h4,h5,h6,header,hgroup,html,i,iframe,img,ins,kbd,label,legend,li,nav,object,ol,p,pre,q,samp,section,small,span,strike,strong,sub,sup,table,tbody,td,tfoot,th,thead,tr,tt,ul,var{margin:0;padding:0;border:0;outline:0;font-size:100%;font:inherit;vertical-align:baseline}body{line-height:1;background-color:#fff;color:#000;font-family:Arial,Helvetica,sans-serif;text-align:left;font-size:12pt;width:100%;max-width:800px;box-sizing:border-box;margin-left:150px;overflow:auto;padding:150px 15px}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:after,blockquote:before,q:after,q:before{content:'';content:none}a:hover,ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}a{transition:.2s ease-in-out;color:inherit;text-decoration:none}ul{margin:0 0 20px;list-style:square;padding-left:40px}b,strong{font-weight:700}i{font-style:italic}button,button:hover,input:focus,input[type=checkcbox]:focus,input[type=submit]:hover,select:focus,textarea:focus{background:0 0;border:0;padding:0;outline:0;line-height:normal;overflow:visible}h1{font-weight:700;font-size:32pt;padding-left:15px;margin-bottom:20px}h2{font-weight:700;font-size:24pt;padding-left:15px;margin-bottom:20px}h3{font-weight:700;font-size:18pt;padding-left:15px;margin-bottom:20px}h4{font-weight:700;font-size:14pt;padding-left:15px;margin-bottom:20px}h5{font-size:14pt;padding-left:15px;margin-bottom:20px}p{font-size:12pt;padding-left:15px;margin-bottom:20px}.block{margin-bottom:20px;padding:15px 2px;border-left:8px solid rgba(0,0,0,.3);border-top:1px solid rgba(0,0,0,.1);transition:.3s}.block:hover{border-left:8px solid #000;box-shadow:0 0 5px 0 rgba(0,0,0,.2)}</style></head><body><div class="block"><h1 id="void-mailbox-setup">Void Mailbox Setup</h1><p>First we start with <a href="#TODO">our regular ArchLinux install on a new server</a>. On top of that we install all the required packages. Then we configure our mailserver as desired.</p><div class="block"><h2 id="collection-of-helpful-ressources">Collection of helpful ressources</h2><ul><li><a href="https://github.com/mail-in-a-box/mailinabox">Mail-in-a-box Github</a><ul><li><a href="https://github.com/mail-in-a-box/mailinabox/blob/main/setup/mail-postfix.sh">Base Postfix Configuration</a></li><li><a href="https://github.com/mail-in-a-box/mailinabox/blob/main/setup/mail-users.sh">Mail User Configuration</a></li><li><a href="https://github.com/mail-in-a-box/mailinabox/blob/main/setup/mail-dovecot.sh">Dovecot Configuration</a></li></ul></li><li><a href="https://github.com/iredmail">IRedMail Github</a></li><li><a href="https://github.com/modoboa">Modoboa Github</a><ul><li><a href="https://github.com/modoboa/modoboa-installer">Modoboa Installer</a></li><li><a href="https://github.com/modoboa/modoboa/blob/master/requirements.txt">Modoboa Requirements</a>. <a href="https://github.com/modoboa/modoboa/blob/master/setup.py">Modoboa setup.py</a></li></ul></li></ul></div><div class="block"><h2 id="required-packages">Required packages</h2><ul><li>postfix</li><li>postfix-pcre</li><li>postfix-sqlite</li><li>sqlite</li><li>postgrey</li><li>ca-certificates</li><li>nginx</li><li>certbot</li><li>certbot-nginx</li><li>dovecot</li><li>rspam</li><li>roundcube</li><li>opendkim</li><li>opendmarc</li></ul></div><div class="block"><h2 id="configuration">Configuration</h2><div class="block"><h3 id="postfix-configuration">Postfix Configuration</h3><p>Postfix is the Mail Transfer Agent(MTA) and is responsible for the transmission of email between servers using the SMTP protocol. By standard it listens on port 25 for incoming emails from other servers and passes the email to the right service for local mail delivery or further mail filtering. Here we use rspam.</p><p>We also want to configure postfix to perform some initial email filtering.</p><ul><li>drop emails from blacklisted source IPs</li><li>apply greylisting (drop email on first arrival)</li><li>check if destination address is valid</li><li>rewrite destination when an alias was used</li></ul><p>Postfix also listens on ports 465/587 for connections from remote users who want to send their emails. Dovecote is being used for user authentication.</p><p>Packages required: <code>postfix postfix-sqlite postfix-pcre postgrey ca-certificates</code></p><div class="block"><h4 id="domain-classes">Domain Classes</h4><p>An important concept for understanding the configuration of Postfix are the Address Classes. Here we have:</p><ul><li>Local Domain Class</li><li>Virtual Alias Domain Class</li><li>Virtual Mailbox Domain Class</li><li>Relay Domain Class</li><li>Default Domain Class</li></ul><div class="block"><h5 id="the-default-domain-class">The Default Domain Class</h5><p>is intended for mail delivery to foreign domains. This is the default case when we use postfix to dispatch an email to any other email address which is not dealt with by out own mailserver.</p><p>The mail delivery transport is specified with the <code>default_transport</code> parameter. The default is <code>smtp</code> as using the smtp delivery agent.</p></div><div class="block"><h5 id="the-relay-domain-class">The Relay Domain Class</h5><p>is very similar to the default domain class, the only difference being that the email has not been dispatched locally via postfix, instead it arrived at our mailserver through the open internet and is destined to an address of a relayed-to foreign domain.</p><p>This foreign domain needs to be specified in the <code>relay_domains</code> parameter. And might be more precisely mapped with the <code>relay_recipient_maps</code> parameter.</p><p>Here the mail delivery transport is specidied with the <code>relay_transport</code> parameter. The default is <code>relay</code> which actually uses the smtp delivery agent.</p></div><div class="block"><h5 id="the-virtual-mailbox-domain-class">The Virtual Mailbox Domain Class</h5><p>is the final delivery for locally hosted mailboxes of users from our hosted domains. Also here the email usually arrives from the open internet and is accepted for virtual mail delivery if we find the recipient configured with the <code>virtual_mailbox_maps</code> parameter.</p><p>You may configure domain names as well with the <code>virtual_mailbox_domains</code> parameter. This parameter defaults to <code>$virtual_mailbox_maps</code>.</p><p>Mail delivery transport is specified with the <code>virtual_transport</code> parameter. Default is <code>virtual</code> which uses the virtual delivery agent.</p></div><div class="block"><h5 id="the-virtual-alias-domain-class">The Virtual Alias Domain Class</h5><p>is a domain class without it&apos;s own delivery transport. Resolving the alias must result in an address of either the virtual mailbox domain class or the local domain class.</p><p>Recipient address aliases are defined with the <code>virtual_alias_maps</code> parameter. Default is <code>$virtual_maps</code>.</p><p>The domain aliases are defined with the <code>virtual_alias_domains</code> parameter. Default is <code>$virtual_alias_maps</code>.</p></div><div class="block"><h5 id="the-local-domain-class">The Local Domain Class</h5><p>is for the non-virtual users having a mailbox on the machine.</p><p>Recipient addresses are defined with the <code>local_recipient_maps</code> parameter.</p><p>The local domains are defined with the <code>mydestination</code> parameter. If we bind any interface e.g. with the <code>inet_interfaces</code> parameter, then also the specified IP address is accepted as local domain.</p><p>Mail delivery transport is specified with the <code>local_transport</code> parameter. Default is <code>local@$myhostname</code> using the local delivery agent.</p></div></div></div></div><p>This paragraph belongs to the main document and not the subsections.</p></div><script>(()=>{var n={62:function(o){!function(){var e={name:"indexdomconnect",initialize:function(){}};o.exports=e}.call(this)}},i={};function t(e){var o=i[e];return void 0!==o||(o=i[e]={exports:{}},n[e].call(o.exports,o,o.exports,t)),o.exports}t.n=e=>{var o=e&&e.__esModule?()=>e.default:()=>e;return t.d(o,{a:o}),o},t.d=(e,o)=>{for(var n in o)t.o(o,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:o[n]})},t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),t.o=(e,o)=>Object.prototype.hasOwnProperty.call(e,o),(()=>{"use strict";var e=function(e){null!=allModules.debugmodule.modulesToDebug.configmodule&&console.log("[configmodule]: "+e)},o={name:"configmodule",uimodule:!1,initialize:function(){e("configmodule.initialize")},prop:!0};const i={configmodule:o,debugmodule:{name:"debugmodule",uimodule:!1,modulesToDebug:{unbreaker:!0,configmodule:!0}}};o=t(62);t.n(o)().initialize(),t.g.allModules=i,async function(){var o,n,e=function(){var e=[];for(n in i)null!=(o=i[n]).initialize&&e.push(o.initialize());return e}();await Promise.all(e)}()})()})()</script></body></html>